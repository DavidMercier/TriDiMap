(Nano-)Indentation mapping
==========================

.. include:: includes.rst

Indentation grid technique
---------------------------

Mechanical property mapping are generated by plotting (nano-)indentation results obtained using the grid indentation technique.
The nanoindentation grid technique is well described in the paper written by Constantinides et al. [#Constantinides_2006]_,
but also in the following references [#Němeček_2009]_ and [#Randall_2009]_.

Position of each (nano-)indentation test or distance between indents has to be known or recorded,
in order to plot a consistent mechanical property map representative of the experiment.

An indentation map is represented mathematically using a matrix of N columns by M rows. If positions of indentation tests are not known,
it is required to know the pattern of indentation tests (line by line, snake shape, diagonals...).

An example of 2D generated hardness map is given below. By default, a pixelized map is plotted.
Each pixel represents an indentation test and the color of a pixel corresponds to the the intensity of the calculated mechanical property.
In the given following screenshot, the white pixels corresponds to tests, which failed (NaN = Not a numeric).
Indentation failure corresponds to traditional artifacts of indentation testing (error on surface detection beceause of contamination/roughness/topography effects, error with the thermal drift correction, etc...) 
A ratio of failed tests over total number of indentation tests is given on the left part of the GUI, to estimate the experimental validity of the indentation tests.
For example, more than 20% of failed tests start to be problematic for the results analysis... But, this is an empirical statement, which depends on the NaN pixels distribution over the map.
To remove these empty pixels, it is possible to tick a checkbox into the settings on the GUI,
and a mechanical property value is attributed to the empty pixel, by doing a simple averaging of the surrounding pixels (8 in total).

.. figure:: ./_pictures/MTS_example1_25x25_H_GUI_00.png
   :scale: 40 %
   :align: center
   
   *Raw 2D hardness map obtained from a 25x25 indentation grid.*

.. figure:: ./_pictures/RemoveNaN.png
   :scale: 40 %
   :align: center
   
   *2D hardness map obtained from a 25x25 indentation grid with (left) and without (right) failed indentation.*  
   
Indentation length scales
---------------------------

According to Constantinides et al. [#Constantinides_2006]_, the indentation depth :math:`h` should be at most 1/10 of the characteristic size of the microstructure :math:`D` (e.g.: particle size in a matrix, grain or void diameter...), in order to apply continuum indentation analysis to heterogeneous systems and  to  access  phase  properties.  This rule refers to the well-known 10% rule of thumb proposed by Buckle [#Buckle_1973]_, which is a rough first estimatio. In cases where the contrast between the mechanical properties of the two phases becomes significant (e.g.: ratio between the elastic modulii lower than 0.2 or higher than 5), the method is not really reliable anymore and special care should be taken in the interpretation of the indentation results.

.. figure:: ./_pictures/grid_indentation_length_scale.png
   :scale: 40 %
   :align: center
   
   *Schematic of the principle of the grid indentation technique for heterogeneous materials.*
   
Interpolation step
-----------------------

The |matlab| function used to interpolate linearly the indentation maps is: `interp2.m <https://fr.mathworks.com/help/matlab/ref/interp2.html>`_

The process of interpolation does not modify the raw data intensity values, but increase the number of pixels, by a given factor of x2, x4, x8 or x16 (default values, which can be modified).
For example, a map of 25x25 linearly interpolated by a factor of x2, becomes a map of 49x49.

.. figure:: ./_pictures/InterpolationStep.png
   :scale: 40 %
   :align: center
   
   *Process of interpolation step.*

Smoothing step
-----------------------

The |matlab| third party code used to smooth the indentation maps is: `smooth2a.m <https://fr.mathworks.com/matlabcentral/fileexchange/23287-smooth2a>`_

This smooth operation of a 2D matrix is based on a mean filter over a user-defined rectangle.
The smoothing step is a solution to apply to smooth sharp peaks or sharp valleys on the mechanical topography.
Sharpness can arises when there is a large difference in term of intensity between 1 pixel and its surrounding neighbors (e.g. surface effect, or hard particle on a soft matrix, etc...).


.. figure:: ./_pictures/SmoothingStep.png
   :scale: 40 %
   :align: center
   
   *Process of smoothing step.*
   
--> Vizualization of the error map

.. figure:: ./_pictures/SmoothingStepError.png
   :scale: 40 %
   :align: center
   
   *Process to obtain error map after smoothing step.*  

The |matlab| function used to interpolate and to smooth the indentation maps using TriDiMap is: `TriDiMap_interpolation_smoothing.m <https://github.com/DavidMercier/TriDiMap/blob/master/matlab_code/module_mapping/TriDiMap_interpolation_smoothing.m>`_

Vizualization of maps
-----------------------

It is possible to plot similar other maps using different functions of Matlab, like 2D, 3D
--> Type of 2D maps
--> Colorbar / Normalization / Translation
--> Log / Grid / Indents positions

..  warning::
    Indentation experiments are very sensitive to environmental effects and thermal drift. Usually, performing such indentation maps can be time-consuming....   


References
-------------
.. [#Constantinides_2006] `Constantinides G. et al., "Grid indentation analysis of composite microstructure and mechanics: Principles and validation" (2006). <https://doi.org/10.1016/j.msea.2006.05.125>`_
.. [#Němeček_2009] `Němeček J., "Nanoindentation of heterogeneous structural materials", PhD thesis (2009). <http://ksm.fsv.cvut.cz/~nemecek/teaching/dmpo/literatura/habilitation%20thesis_Nemecek_CTU-01-2010.pdf>`_
.. [#Randall_2009] `Randall N.X. et al., "Nanoindentation analysis as a two-dimensional tool for mapping the mechanical properties of complex surfaces" (2009). <https://doi.org/10.1557/jmr.2009.0149>`_
.. [#Buckle_1973] Buckle H., in: J.W. Westbrook, H. Conrad (Eds.), The Science of Hardness Testing and Its Applications, American Society for Metals, Metal Park OH, 1973, pp. 453–459.
